- name: 4.1.3.3 Ensure events that modify the sudo log file are collected (Automated)
  block:
    - name: 4.1.3.3 Ensure events that modify the sudo log file are collected (Automated) | Get sudo log file
      shell: grep -r logfile /etc/sudoers* | sed -e 's/.*logfile=//;s/,? .*//' -e 's/"//g'
      register: SUDO_LOG_FILE
      changed_when: false
    - name: 4.1.3.3 Ensure events that modify the sudo log file are collected (Automated) | Create or Edit Audit Rules File
      template:
        src: template_4_1_3_3.j2
        dest: /etc/audit/rules.d/50-sudo.rules
      when: SUDO_LOG_FILE_ESCAPED is defined 
    - name: Display error message if SUDO_LOG_FILE is unset
      debug:
        msg: "ERROR: Variable 'SUDO_LOG_FILE_ESCAPED' is unset."
      when: SUDO_LOG_FILE_ESCAPED is not defined 
      
     
